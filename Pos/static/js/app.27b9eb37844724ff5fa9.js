webpackJsonp([1],{0:function(t,e){},"2mjs":function(t,e){},"3qUN":function(t,e){},JA5Q:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("Y8t/"),a={getVipList:function(t,e,o){return s.get("/vip/getVipList",t).then(e).catch(o)},addVipUser:function(t,e,o){return s.post("/vip/addVipUser",t).then(e).catch(o)},getVipFoodsList:function(t,e,o){return s.get("/vip/getVipFoodsList",t).then(e).catch(o)},addVipFoodsList:function(t,e,o){return s.post("/vip/addVipFoodsList",t).then(e).catch(o)}};e.default=a},NHnr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("7+uW"),a={meunArr:[{name:"收银",id:"money",to:"/money",isRoot:!1,icon:"icon iconfont icon-goumai"},{name:"商品",id:"commodity",to:"/commodity",isRoot:!1,icon:"icon iconfont icon-hanbao"},{name:"会员",id:"member",to:"/member",isRoot:!1,icon:"icon iconfont icon-huiyuanqia"},{name:"统计",id:"statistics",to:"/statistics",isRoot:!1,icon:"icon iconfont icon-tongji"},{name:"设置",id:"setting",to:"/setting",isRoot:!1,icon:"icon iconfont icon-gongnengjianyi"}]},i={name:"leftNav",data:function(){return{meunArr:[],user:null,headerUser:!1}},created:function(){var t=this;localStorage.getItem("pos_user")&&(this.user=JSON.parse(localStorage.getItem("pos_user")),this.meunArr=a.meunArr),window.addEventListener("setItem",function(){t.user=JSON.parse(localStorage.getItem("pos_user")),t.meunArr=a.meunArr})},methods:{showHeaderUser:function(){this.user&&(this.headerUser=!0)},hideHeaderUser:function(){this.headerUser=!1},loginOut:function(){localStorage.clear(),this.$router.go()}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:t.meunArr.length?"left-nav":"defa-nav"},[o("ul",{staticStyle:{position:"relative"}},[t._l(t.meunArr,function(e){return o("li",{key:e.name},[o("router-link",{attrs:{to:e.to}},[o("i",{class:e.icon}),t._v(" "),o("div",[t._v(t._s(e.name))])])],1)}),t._v(" "),t.user?o("li",{on:{mouseover:t.showHeaderUser,mouseleave:t.hideHeaderUser}},[o("el-tooltip",{attrs:{content:t.user.name,placement:"top",effect:"light"}},[o("el-avatar",{attrs:{src:t.user.userImg,size:60}})],1),t._v(" "),o("transition",{attrs:{name:"slide-fade"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.headerUser,expression:"headerUser"}],staticClass:"headerUser"},[o("span",{on:{click:t.loginOut}},[t._v("退出")])])])],1):t._e()],2)])},staticRenderFns:[]};var r={name:"App",components:{leftNav:o("VU/8")(i,n,!1,function(t){o("iEk4")},"data-v-764f66d1",null).exports},created:function(){if(localStorage.getItem("pos_user")){var t=JSON.parse(localStorage.getItem("pos_user"));this.$store.commit("setUserAccount",t.account),this.$store.commit("setUserName",t.name)}}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("leftNav"),this._v(" "),e("div",{staticClass:"main"},[e("router-view")],1)],1)},staticRenderFns:[]};var l=o("VU/8")(r,c,!1,function(t){o("lFqa")},null,null).exports,d=o("/ocq"),u=o("mvHQ"),f=o.n(u),m=o("Dd8w"),p=o.n(m),v={name:"money",data:function(){return{activeName:"dainc",activeName1:"",totalNum:0,totalNums:0,totalMoney:0,totalMoneys:0,tableData:[],tableDatas:[],oftenGoods:[],foodsMap:{},dialogFormVisible:!1,formLabelWidth:"120px",form:{vipId:null},foodType:[],defaultImg:o("oYEz")}},created:function(){this.getFoodsType(),this.getOftenFoods()},mounted:function(){var t=document.body.clientHeight;document.querySelector("#order").style.height=t+"px"},methods:{getOftenFoods:function(){var t=this;this.$api.foodApi.getOftenFoods({user:this.$store.state.userAccount},function(e){200===e.code?t.oftenGoods=e.data:t.oftenGoods=[]})},getFoodsType:function(){var t=this;this.$api.foodApi.getFoodsType({user:this.$store.state.userAccount},function(e){if(200===e.code){t.foodType=e.data,t.foodType.forEach(function(t){t.foodTypeId+=""}),e.data.map(function(t){return t.foodTypeId}).forEach(function(e){t.foodsMap[e]||t.$set(t.foodsMap,e+"",[])});var o=t.foodType[0].foodTypeId+"";t.getFoodsList(o),t.activeName1=o}else t.foodType=[]})},getFoodsList:function(t){var e=this;this.$api.foodApi.getFoodsList({type:t},function(o){200===o.code?e.foodsMap[t]=o.data:e.foodsMap[t]=[]})},handleClick:function(t,e){this.getFoodsList(t.name)},addothenList:function(t){for(var e=!1,o=0;o<this.tableData.length;o++)if(this.tableData[o].foodsId===t.foodsId){e=!0;break}if(e){this.tableData.filter(function(e){return e.foodsId===t.foodsId})[0].count++}else{var s=p()({},t,{count:1});this.tableData.push(s)}this.changetotal()},changetotal:function(){this.totalNum=0,this.totalMoney=0;for(var t=0;t<this.tableData.length;t++)this.totalNum+=this.tableData[t].count,this.totalMoney+=this.tableData[t].foodsPrice*this.tableData[t].count},add:function(t,e){this.$set(this.tableData[t],"count",++this.tableData[t].count),this.changetotal()},reduce:function(t,e){var o=this;this.$set(this.tableData[t],"count",--this.tableData[t].count),0===this.tableData[t].count&&(this.tableData=this.tableData.filter(function(e){return e.foodsId!==o.tableData[t].foodsId})),this.changetotal()},reduceAll:function(){this.tableData=[],this.totalNum=0,this.totalMoney=0},reduceAlls:function(){this.tableDatas=[],this.totalNums=0,this.totalMoneys=0},successAll:function(t){var e=this;e.tableData.forEach(function(t){return t.foodsImg=""});var o={vipId:t?e.form.vipId:"1",foodlist:f()(e.tableData),price:e.totalMoney,times:(new Date).getTime(),user:this.$store.state.userAccount};e.$api.vipApi.addVipFoodsList(o,function(t){200===t.code?(e.$message({message:"结账成功，感谢你又为店里贡献了"+e.totalMoney+"元!",type:"success"}),e.tableData=[],e.totalNum=0,e.totalMoney=0,e.dialogFormVisible=!1):e.$message({message:t.msg,type:"warning"})})},guadan:function(){this.tableDatas=this.tableData,this.totalNums=this.totalNum,this.totalMoneys=this.totalMoney,this.activeName="guad",this.tableData=[],this.totalNum=0,this.totalMoney=0},qxguadan:function(){this.tableData=this.tableDatas,this.totalNum=this.totalNums,this.totalMoney=this.totalMoneys,this.activeName="dainc",this.tableDatas=[],this.totalNums=0,this.totalMoneys=0}}},h={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pos"},[o("el-row",[o("el-col",{staticClass:"pos-order",attrs:{span:10,id:"order"}},[o("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"点餐",name:"dainc"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:t.tableData}},[o("el-table-column",{attrs:{prop:"foodsName",label:"商品名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"count",label:"数量",width:"70"}}),t._v(" "),o("el-table-column",{attrs:{prop:"foodsPrice",label:"金额",width:"70"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(o){return o.preventDefault(),t.reduce(e.$index,t.tableData)}}},[t._v("删除\n                ")]),t._v(" "),o("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(o){return o.preventDefault(),t.add(e.$index,t.tableData)}}},[t._v("添加\n                ")])]}}])})],1),t._v(" "),o("div",{staticClass:"totalDiv"},[o("span",[t._v("数量：")]),t._v(t._s(t.totalNum)+" "),o("span",[t._v("金额：")]),t._v(t._s(t.totalMoney)+"元\n          ")]),t._v(" "),o("div",{staticStyle:{"margin-top":"20px"}},[o("el-button",{attrs:{type:"warning"},on:{click:t.guadan}},[t._v("挂单")]),t._v(" "),o("el-button",{attrs:{type:"danger"},on:{click:t.reduceAll}},[t._v("删除")]),t._v(" "),o("el-button",{attrs:{type:"success"},on:{click:function(e){return t.successAll()}}},[t._v("结账")]),t._v(" "),o("el-button",{attrs:{type:"success"},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("会员结账")])],1)],1),t._v(" "),o("el-tab-pane",{attrs:{label:"挂单",name:"guad"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:t.tableDatas}},[o("el-table-column",{attrs:{prop:"foodsName",label:"商品名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"count",label:"数量",width:"70"}}),t._v(" "),o("el-table-column",{attrs:{prop:"foodsPrice",label:"金额",width:"70"}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120",fixed:"right"}},[[o("el-button",{attrs:{type:"text",size:"small",disabled:""}},[t._v("删除")]),t._v(" "),o("el-button",{attrs:{type:"text",size:"small",disabled:""}},[t._v("添加")])]],2)],1),t._v(" "),o("div",{staticClass:"totalDiv"},[o("span",[t._v("数量：")]),t._v(t._s(t.totalNums)+" "),o("span",[t._v("金额：")]),t._v(t._s(t.totalMoneys)+"元\n          ")]),t._v(" "),o("div",{staticStyle:{"margin-top":"20px"}},[o("el-button",{attrs:{type:"warning"},on:{click:t.qxguadan}},[t._v("取消挂单")]),t._v(" "),o("el-button",{attrs:{type:"danger"},on:{click:t.reduceAlls}},[t._v("删除")])],1)],1)],1)],1),t._v(" "),o("el-col",{attrs:{span:14}},[o("div",{staticClass:"often-goods"},[o("div",{staticClass:"title"},[t._v("常用商品")]),t._v(" "),o("div",{staticClass:"often-goods-list"},[o("ul",t._l(t.oftenGoods,function(e,s){return o("li",{key:s,on:{click:function(o){return t.addothenList(e)}}},[o("span",[t._v(t._s(e.foodsName))]),t._v(" "),o("span",{staticClass:"o-price"},[t._v("￥"+t._s(e.foodsPrice)+"元")])])}),0)])]),t._v(" "),o("div",{staticClass:"goods-type"},[o("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName1,callback:function(e){t.activeName1=e},expression:"activeName1"}},[t._l(t.foodType,function(e){return[o("el-tab-pane",{key:e.foodTypeId,attrs:{label:e.foodTypeName,name:e.foodTypeId}},[o("div",[o("ul",{staticClass:"cookList"},t._l(t.foodsMap[e.foodTypeId],function(e,s){return o("li",{key:s,on:{click:function(o){return t.addothenList(e)}}},[o("span",{staticClass:"foodImg"},[o("img",{attrs:{src:e.foodsImg||t.defaultImg,width:"100%"}})]),t._v(" "),o("span",{staticClass:"foodName"},[t._v(t._s(e.foodsName))]),t._v(" "),o("span",{staticClass:"foodPrice"},[t._v("￥"+t._s(e.foodsPrice)+"元")])])}),0)])])]})],2)],1)])],1),t._v(" "),o("el-dialog",{attrs:{title:"会员号",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{attrs:{model:t.form}},[o("el-form-item",{attrs:{label:"会员编号","label-width":t.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.vipId,callback:function(e){t.$set(t.form,"vipId",e)},expression:"form.vipId"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.successAll("vip")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var g=o("VU/8")(v,h,!1,function(t){o("iQ4y")},null,null).exports,b={props:["fooddata","foodindex"],data:function(){return{fooddata1:this.fooddata,defaultImg:o("oYEz")}},methods:{deleteds:function(t){this.$emit("deletedclick",t)},setOfter:function(t){this.$emit("setOfterclick",t)}},watch:{fooddata:{handler:function(t){this.fooddata1=t},deep:!0}}},y={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"left-nav"},[o("ul",{staticClass:"cookList"},t._l(t.fooddata1,function(e,s){return o("li",{key:s},[o("span",{staticClass:"deleted",on:{click:function(o){return t.deleteds(e.foodsId)}}},[t._v("X")]),t._v(" "),o("span",{staticClass:"oftenFoods",style:{color:"1"===e.oftenFoods?"#fab72b":""},on:{click:function(o){return t.setOfter({id:e.foodsId,oftenFoods:e.oftenFoods})}}},[o("i",{staticClass:"el-icon-star-on"})]),t._v(" "),o("span",{staticClass:"foodImg"},[o("img",{attrs:{src:e.foodsImg||t.defaultImg,width:"100%"}})]),t._v(" "),o("span",{staticClass:"foodName"},[t._v(t._s(e.foodsName))]),t._v(" "),o("span",{staticClass:"foodPrice"},[t._v("￥"+t._s(e.foodsPrice)+"元")])])}),0)])},staticRenderFns:[]};var _={name:"commodity",data:function(){return{activeName:"",form:{foodsName:"",foodsPrice:0,foodsImg:"",oftenFoods:0},formLabelWidth:"120px",dialogFormVisible:!1,foodType:[],foodsMap:{},rules:{foodsName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],foodsPrice:[{required:!0,message:"请输入商品价格",trigger:"blur"}],foodsImg:[{required:!1,message:"请选择商品图片",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,addFoodTypeVisible:!1,typeForm:{foodTypeName:""},typeRules:{foodTypeName:[{required:!0,message:"请输入商品分类",trigger:"blur"}]}}},components:{foodList:o("VU/8")(b,y,!1,function(t){o("3qUN")},"data-v-12f23150",null).exports},created:function(){this.getFoodsType()},methods:{getFoodsType:function(){var t=this;this.$api.foodApi.getFoodsType({user:this.$store.state.userAccount},function(e){if(200===e.code){t.foodType=e.data,t.foodType.forEach(function(t){t.foodTypeId+=""}),e.data.map(function(t){return t.foodTypeId}).forEach(function(e){t.foodsMap[e]||t.$set(t.foodsMap,e+"",[])});var o=t.foodType[t.foodType.length-1].foodTypeId+"";t.getFoodsList(o),t.activeName=o}else t.foodType=[]})},getFoodsList:function(t){var e=this;this.$api.foodApi.getFoodsList({type:t},function(o){200===o.code?e.foodsMap[t]=o.data:e.foodsMap[t]=[]})},handleRemove:function(t,e){console.log(t,e),this.form.foodsImg=""},handlePictureCardPreview:function(t){var e=this,o=new FileReader;o.readAsDataURL(t.file),o.onload=function(t){e.dealImage(t.target.result,function(t){e.form.foodsImg=t,console.log(e.form.foodsImg)})}},dealImage:function(t,e){var o,s,a=new Image,i=.6;a.src=t,a.setAttribute("crossOrigin","Anonymous"),a.onload=function(){o=this.width,s=this.height;var t=document.createElement("canvas"),a=t.getContext("2d");Math.max(o,s)>120?o>s?(t.width=120,t.height=120*s/o):(t.height=120,t.width=120*o/s):(t.width=o,t.height=s,i=.6),a.clearRect(0,0,t.width,t.height),a.drawImage(this,0,0,t.width,t.height);for(var n=t.toDataURL("image/jpeg",i);n.length/1024>10;)i-=.01,n=t.toDataURL("image/jpeg",i);for(;n.length/1024<5;)i+=.001,n=t.toDataURL("image/jpeg",i);e(n)}},handleClick:function(t,e){this.getFoodsList(t.name)},removeTab:function(t){var e=this;this.$confirm("是否确定删除该分类及其所属商品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$api.foodApi.deleteFoodType({id:t},function(t){200===t.code?(e.getFoodsType(),e.$message({type:"success",message:"删除成功!"})):e.$message({type:"error",message:t.msg})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},deleteds:function(t){var e=this;this.$confirm("是否确定删除该商品","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$api.foodApi.deleteFoods({id:t},function(t){200===t.code?(e.getFoodsList(e.activeName),e.$message({type:"success",message:"删除成功!"})):e.$message({type:"error",message:t.msg})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},setOfterclick:function(t){var e=this;this.$api.foodApi.setOftenFoods({id:t.id,oftenFoods:"0"===t.oftenFoods?"1":"0"},function(t){200===t.code?(e.getFoodsList(e.activeName),e.$message({type:"success",message:"设置成功!"})):e.$message({type:"error",message:t.msg})})},addfoods:function(t){var e=this;this.$refs[t].validate(function(o){if(o){var s=p()({},e.form);s.oftenFoods=s.oftenFoods?1:0,s.foodTypeId=Number(e.activeName),s.user=e.$store.state.userAccount,e.$api.foodApi.addFoodsDetail(s,function(o){200===o.code?(e.getFoodsList(e.activeName),e.$message({message:"添加成功",type:"success"}),e.$refs[t].resetFields(),e.dialogFormVisible=!1):e.$message({message:o.msg,type:"error"})})}})},addfoodType:function(t){var e=this;this.$refs[t].validate(function(o){o&&e.$api.foodApi.addFoodsType({foodTypeName:e.typeForm.foodTypeName,user:e.$store.state.userAccount},function(o){200===o.code?(e.getFoodsType(e.activeName),e.$message({message:"添加成功",type:"success"}),e.$refs[t].resetFields(),e.addFoodTypeVisible=!1):e.$message({message:o.msg,type:"error"})})})}}},F={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row",[o("el-button",{attrs:{type:"primary",round:""},on:{click:function(e){t.addFoodTypeVisible=!0}}},[t._v("添加分类")]),t._v(" "),o("el-button",{attrs:{type:"primary",round:""},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("添加商品")])],1),t._v(" "),o("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-click":t.handleClick,"tab-remove":t.removeTab},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t._l(t.foodType,function(e){return[o("el-tab-pane",{key:e.foodTypeId,attrs:{label:e.foodTypeName,name:e.foodTypeId}},[o("food-list",{attrs:{fooddata:t.foodsMap[e.foodTypeId]},on:{deletedclick:t.deleteds,setOfterclick:t.setOfterclick}})],1)]})],2),t._v(" "),o("el-dialog",{attrs:{title:"添加商品分类",visible:t.addFoodTypeVisible},on:{"update:visible":function(e){t.addFoodTypeVisible=e}}},[o("el-form",{ref:"typeForm",attrs:{model:t.typeForm,rules:t.typeRules}},[o("el-form-item",{attrs:{label:"分类名称","label-width":t.formLabelWidth,prop:"foodTypeName"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.typeForm.foodTypeName,callback:function(e){t.$set(t.typeForm,"foodTypeName","string"==typeof e?e.trim():e)},expression:"typeForm.foodTypeName"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.addFoodTypeVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addfoodType("typeForm")}}},[t._v("确 定")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"添加商品",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"商品名称","label-width":t.formLabelWidth,prop:"foodsName"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.foodsName,callback:function(e){t.$set(t.form,"foodsName","string"==typeof e?e.trim():e)},expression:"form.foodsName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"单价","label-width":t.formLabelWidth,prop:"foodsPrice"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.foodsPrice,callback:function(e){t.$set(t.form,"foodsPrice",t._n(e))},expression:"form.foodsPrice"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"常用","label-width":t.formLabelWidth,prop:"oftenFoods"}},[o("el-switch",{model:{value:t.form.oftenFoods,callback:function(e){t.$set(t.form,"oftenFoods",e)},expression:"form.oftenFoods"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"图片","label-width":t.formLabelWidth,prop:"foodsImg"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"http-request":t.handlePictureCardPreview}},[t.form.foodsImg?o("img",{staticClass:"avatar",attrs:{src:t.form.foodsImg}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addfoods("form")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var N=o("VU/8")(_,F,!1,function(t){o("euWM")},"data-v-3a850594",null).exports,w={name:"setting",data:function(){return{userFrom:{name:this.$store.state.userName,account:this.$store.state.userAccount,userImg:""}}},created:function(){var t=JSON.parse(localStorage.getItem("pos_user"));this.userFrom=p()({},t),console.log(this.userFrom)},methods:{submitbtn:function(){var t=this;this.$api.loginApi.editUser(this.userFrom,function(e){200===e.code?(t.resetSetItem("pos_user",f()({account:t.userFrom.account,name:t.userFrom.name,userImg:t.userFrom.userImg})),t.$store.commit("setUserAccount",t.userFrom.account),t.$store.commit("setUserName",t.userFrom.name),t.$message.success("更新成功")):t.$message.error(e.msg)})},handlePictureCardPreview:function(t){var e=this,o=new FileReader;o.readAsDataURL(t.file),o.onload=function(t){e.dealImage(t.target.result,function(t){console.log(t),e.userFrom.userImg=t})}},dealImage:function(t,e){var o,s,a=new Image,i=.6;a.src=t,a.setAttribute("crossOrigin","Anonymous"),a.onload=function(){o=this.width,s=this.height;var t=document.createElement("canvas"),a=t.getContext("2d");Math.max(o,s)>120?o>s?(t.width=120,t.height=120*s/o):(t.height=120,t.width=120*o/s):(t.width=o,t.height=s,i=.6),a.clearRect(0,0,t.width,t.height),a.drawImage(this,0,0,t.width,t.height);for(var n=t.toDataURL("image/jpeg",i);n.length/1024>10;)i-=.01,n=t.toDataURL("image/jpeg",i);for(;n.length/1024<5;)i+=.001,n=t.toDataURL("image/jpeg",i);e(n)}}}},I={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"poscfig"},[o("el-row",[o("el-col",{attrs:{span:20,offset:1}},[o("div",{staticStyle:{"margin-bottom":"15px"}},[t._v("\n                用户名：\n                "),o("el-input",{staticStyle:{width:"300px"},model:{value:t.userFrom.name,callback:function(e){t.$set(t.userFrom,"name",e)},expression:"userFrom.name"}})],1),t._v(" "),o("div",[o("p",{staticStyle:{"margin-bottom":"15px"}},[t._v("用户头像：")]),t._v(" "),o("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,"http-request":t.handlePictureCardPreview}},[t.userFrom.userImg?o("img",{staticClass:"avatar",attrs:{src:t.userFrom.userImg}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),o("div",{staticStyle:{"margin-top":"10px"}},[o("el-row",[o("el-button",{attrs:{type:"primary",round:"",size:"small"},on:{click:t.submitbtn}},[t._v("保存设置")])],1)],1)])],1)],1)},staticRenderFns:[]};var $=o("VU/8")(w,I,!1,function(t){o("mQWg")},"data-v-ae647b7a",null).exports,A=o("Icdr");o("GbHy"),o("Oq2I"),o("miEh");var x={name:"statustics",data:function(){return{}},created:function(){},mounted:function(){this.getFoodslist(),this.getFoodsviplist(),this.getAddVipList()},methods:{getFoodslist:function(){var t=this;this.$api.foodApi.getFoodsAllList({endTime:(new Date).getTime()-7776e6,user:this.$store.state.userAccount},function(e){if(200===e.code){var o=(new Date).getTime(),s=[],a=[];e.data.sort(function(t,e){return e.times-t.times}),e.data.map(function(e){e.foodlist=JSON.parse(e.foodlist),o-e.times<2592e6&&t.filterFoods(e,s),o-e.times<7776e6&&t.filterFoods(e,a)}),console.log(s,a),t.initEchart(s,"foodsTop","近一月热销商品"),t.initEchart(a,"foodsTopJidu","近三月热销商品")}})},getFoodsviplist:function(){var t=this;this.$api.foodApi.getFoodsVIPAllList({endTime:(new Date).getTime()-2592e6,user:this.$store.state.userAccount},function(e){if(200===e.code){var o=[];e.data.sort(function(t,e){return e.times-t.times}),e.data.map(function(e){e.foodlist=JSON.parse(e.foodlist),t.filterFoods(e,o)}),t.initEchart(o,"vipFoods","VIP常购商品")}})},getAddVipList:function(){var t=this,e=(new Date).getFullYear(),o=new Date(e+"-01-01 0:0:0").getTime();this.$api.vipApi.getVipList({endTime:o,user:this.$store.state.userAccount},function(e){if(200===e.code){var o=[];e.data.forEach(function(t){var e=o.find(function(e){return e.times===t.times});e?e.count+=1:(e={times:t.times,count:1},o.push(e))}),o.sort(function(t,e){return t.times-e.times}),A.init(document.getElementById("vipNum")).setOption({title:{text:"新增vip数量（近一年）"},tooltip:{},xAxis:{data:o.map(function(e){return t.filterTime(e.times)})},yAxis:{},series:[{name:"新增",type:"bar",data:o.map(function(t){return t.count})}]})}})},filterFoods:function(t,e){t.foodlist.forEach(function(t){var o=e.find(function(e){return e.foodsId===t.foodsId});o?o.count+=t.count:(o={count:t.count,foodsName:t.foodsName,foodsId:t.foodsId},e.push(o))})},initEchart:function(t,e,o){t=t.sort(function(t,e){return e.count-t.count}).splice(0,5),A.init(document.getElementById(e)).setOption({title:{text:o},tooltip:{},xAxis:{data:t.map(function(t){return t.foodsName})},yAxis:{},series:[{name:"数量",type:"bar",data:t.map(function(t){return t.count})}]})},filterTime:function(t){var e=new Date(Number(t));return e.getMonth()+1+"-"+e.getDate()}}},T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-row",[e("el-col",{attrs:{span:10,offset:1}},[e("div",{staticStyle:{width:"100%",height:"50vh"},attrs:{id:"foodsTop"}})]),this._v(" "),e("el-col",{attrs:{span:10,offset:1}},[e("div",{staticStyle:{width:"100%",height:"50vh"},attrs:{id:"foodsTopJidu"}})]),this._v(" "),e("el-col",{attrs:{span:10,offset:1}},[e("div",{staticStyle:{width:"100%",height:"50vh"},attrs:{id:"vipFoods"}})]),this._v(" "),e("el-col",{attrs:{span:10,offset:1}},[e("div",{staticStyle:{width:"100%",height:"50vh"},attrs:{id:"vipNum"}})])],1)],1)},staticRenderFns:[]};var D=o("VU/8")(x,T,!1,function(t){o("SRYM")},"data-v-f192d53e",null).exports,k=o("Icdr");o("GbHy"),o("Oq2I"),o("miEh");var V={name:"member",data:function(){return{form:{times:null,vipName:"",vipId:null,user:this.$store.state.userAccount},dialogFormVisible:!1,searchinput:"",formLabelWidth:"120px",vipsData:[],activeName:"1",currVip:{}}},computed:{currVipsData:function(){var t=this;return this.searchinput?this.vipsData.filter(function(e){return e.vipId.indexOf(t.searchinput)>-1}):this.vipsData}},created:function(){this.getVipList()},mounted:function(){var t=document.body.clientHeight;document.querySelector("#order").style.height=t+"px",document.querySelector("#orders").style.height=t+"px",document.querySelector("#viplistbox").style.height=t-60+"px",document.querySelector("#goumaijilv").style.maxHeight=t-376+"px"},methods:{getVipList:function(){var t=this;this.$api.vipApi.getVipList({user:this.$store.state.userAccount},function(e){t.vipsData=[],200===e.code&&(t.vipsData=e.data.sort(function(t,e){return e.times-t.times}),t.xiangqin(e.data[0]))})},addvips:function(){var t=this;this.form.times=new Date(this.form.times).getTime(),this.$api.vipApi.addVipUser(this.form,function(e){200===e.code?(t.getVipList(),t.dialogFormVisible=!1,t.form={times:null,vipName:"",vipId:null,user:t.$store.state.userAccount}):t.$message({message:"添加会员失败",type:"warning"})})},vipbox:function(){var t=new Date;this.form.times=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),this.form.vipId=t.getFullYear()+""+t.getTime(),this.dialogFormVisible=!0},xiangqin:function(t){var e=this;this.currVip=p()({},t),this.$api.vipApi.getVipFoodsList({vipId:t.vipId},function(t){if(200===t.code){var o=[],s={},a=(new Date).getTime(),i=[];t.data.sort(function(t,e){return e.times-t.times}),t.data.map(function(t){var e=new Date(Number(t.times)),n=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();console.log(n),t.foodlist=JSON.parse(t.foodlist),o.includes(t.times)||(o.push(t.times),s[n]=[]),s[n].push(t),a-t.times<2592e6&&t.foodlist.forEach(function(t){var e=i.find(function(e){return e.foodsId===t.foodsId});e?e.count+=t.count:(e={count:t.count,foodsName:t.foodsName,foodsId:t.foodsId},i.push(e))})}),console.log(i),e.initEchart(i),e.$set(e.currVip,"foodObj",s),console.log(e.currVip)}})},initEchart:function(t){t=t.sort(function(t,e){return e.count-t.count}).splice(0,5),k.init(document.getElementById("vipecharts")).setOption({title:{text:"近一月常购商品"},tooltip:{},xAxis:{data:t.map(function(t){return t.foodsName})},yAxis:{},series:[{name:"数量",type:"bar",data:t.map(function(t){return t.count})}]})}},filters:{filterTime:function(t){var e=new Date(Number(t));return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}}},L={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row",[o("el-col",{staticClass:"pos-order",attrs:{span:16,id:"orders"}},[o("el-row",[o("el-col",{attrs:{span:20,offset:2}},[t.currVip?o("div",[o("p",[t._v("客户名称："+t._s(t.currVip.vipName))]),t._v(" "),o("p",[t._v("客户编号："+t._s(t.currVip.vipId))]),t._v(" "),o("p",[t._v("加入日期："+t._s(t.currVip.times))]),t._v(" "),o("p",[t._v("购买记录：")])]):t._e(),t._v(" "),o("div",{attrs:{id:"goumaijilv"}},[o("el-collapse",{attrs:{accordion:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.currVip.foodObj,function(e,s,a){return o("el-collapse-item",{key:a,attrs:{title:s,name:a+1}},[o("ul",[t._l(e[0].foodlist,function(e,s){return o("li",{key:s},[o("span",[t._v(t._s(e.foodsName))]),t._v(" "),o("span",[t._v(t._s(e.count))]),t._v(" "),o("span",[t._v("￥"+t._s(e.foodsPrice))])])}),t._v(" "),o("li",[o("span",[t._v(" ")]),t._v(" "),o("span",[t._v(" ")]),t._v(" "),o("span",{staticStyle:{color:"red"}},[t._v("总计：￥"+t._s(e[0].price))])])],2)])}),1)],1),t._v(" "),o("div",{staticStyle:{height:"300px"},attrs:{id:"vipecharts"}})])],1)],1),t._v(" "),o("el-col",{staticClass:"pos-order",attrs:{span:8,id:"order"}},[o("el-row",[o("el-col",{attrs:{span:12}},[o("el-input",{model:{value:t.searchinput,callback:function(e){t.searchinput=e},expression:"searchinput"}})],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-button",{staticStyle:{opacity:"0"},attrs:{type:"primary",round:""}},[t._v("搜索")])],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-button",{attrs:{type:"primary",round:""},on:{click:t.vipbox}},[t._v("添加")])],1)],1),t._v(" "),o("div",{attrs:{id:"viplistbox"}},t._l(t.currVipsData,function(e,s){return o("div",{key:s},[o("div",{on:{click:function(o){return t.xiangqin(e)}}},[o("el-card",{attrs:{shadow:"hover"}},[o("p",[t._v("会员名："+t._s(e.vipName))]),t._v(" "),o("p",[t._v("加入日期："+t._s(t._f("filterTime")(e.times)))]),t._v(" "),o("p",[t._v("会员编号："+t._s(e.vipId))])])],1)])}),0)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"新增会员",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{attrs:{model:t.form}},[o("el-form-item",{attrs:{label:"会员名","label-width":t.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.vipName,callback:function(e){t.$set(t.form,"vipName",e)},expression:"form.vipName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"会员编号","label-width":t.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:t.form.vipId,callback:function(e){t.$set(t.form,"vipId",e)},expression:"form.vipId"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"加入日期","label-width":t.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",disabled:!0},model:{value:t.form.times,callback:function(e){t.$set(t.form,"times",e)},expression:"form.times"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.addvips}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var U=o("VU/8")(V,L,!1,function(t){o("wk+j")},"data-v-8950fa3a",null).exports,S={name:"login",data:function(){return{formData:{user:"",pwd:""},rules:{user:[{required:!0,message:"请输入用户名",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{onSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.$api.loginApi.getUser(e.formData,function(t){200===t.code?(e.resetSetItem("pos_user",f()({account:t.data[0].userAccount,name:t.data[0].userName,userImg:t.data[0].userImg})),e.$store.commit("setUserAccount",t.data[0].userAccount),e.$store.commit("setUserName",t.data[0].userName),e.$router.push({path:"/money"}),e.$message.success("您好 "+(t.data[0].userName||t.data[0].userAccount)+" ，欢迎上线")):e.$message.error(t.msg)})})},onAddSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.$api.loginApi.addUser(e.formData,function(t){200===t.code?(e.resetSetItem("pos_user",f()({account:e.formData.user,name:""})),e.$store.commit("setUserAccount",e.formData.user),e.$store.commit("setUserName",""),e.$router.push({path:"/money"}),e.$message.success("您好 "+e.formData.user+" ，欢迎上线")):e.$message.error(t.msg)})})}}},C={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"fixed_center"},[o("el-form",{ref:"ruleForm",attrs:{"label-position":"right","label-width":"80px",model:t.formData,rules:t.rules}},[o("el-form-item",{attrs:{label:"用户名",prop:"name"}},[o("el-input",{model:{value:t.formData.user,callback:function(e){t.$set(t.formData,"user",e)},expression:"formData.user"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[o("el-input",{model:{value:t.formData.pwd,callback:function(e){t.$set(t.formData,"pwd",e)},expression:"formData.pwd"}})],1),t._v(" "),o("el-form-item",[o("el-button",[t._v("取消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("ruleForm")}}},[t._v("登录")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onAddSubmit("ruleForm")}}},[t._v("注册")])],1)],1)],1)},staticRenderFns:[]};var M=o("VU/8")(S,C,!1,function(t){o("neo8")},"data-v-083e429e",null).exports,O=o("zL8q"),E=o.n(O);s.default.use(d.a);var P=new d.a({routes:[{path:"/",name:"login",component:M},{path:"/money",name:"money",component:g},{path:"/commodity",name:"commodity",component:N},{path:"/setting",name:"setting",component:$},{path:"/statistics",name:"statistics",component:D},{path:"/member",name:"member",component:U}]});P.beforeEach(function(t,e,o){localStorage.getItem("pos_user")||"login"==t.name?o():o({path:"/"})});var R=P,j=(o("tvR6"),o("PGL6"),o("2mjs"),o("gyMJ")),q=o("NYxO"),W={userName:"",userAccount:""},Y={getUserName:function(t){return t.userName},getUserAccount:function(t){return t.userAccount}},J={setUserName:function(t,e){t.userName=e},setUserAccount:function(t,e){t.userAccount=e}},H={setUserName:function(t){t.commit("setUserName")},setUserAccount:function(t){t.commit("setUserAccount")}};s.default.use(q.a);var z=new q.a.Store({state:W,getters:Y,mutations:J,actions:H});s.default.use(E.a),s.default.config.productionTip=!1,s.default.prototype.Common=a,s.default.prototype.$api=j.default,s.default.prototype.resetSetItem=function(t,e){var o=document.createEvent("StorageEvent");return function(t,e){localStorage.setItem(t,e),o.initStorageEvent("setItem",!1,!1,t,null,e,null,null),window.dispatchEvent(o)}(t,e)},new s.default({el:"#app",router:R,store:z,components:{App:l},template:"<App/>"})},PGL6:function(t,e){},SRYM:function(t,e){},"Y8t/":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new n.a(function(o,s){p.get(t,{params:e}).then(function(t){o(t.data)}).catch(function(t){s(t)})})},e.post=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new n.a(function(o,s){p.post(t,u.a.stringify(e)).then(function(t){o(t.data)},function(t){s(t)})})},e.postBody=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new n.a(function(o,s){p.post(t,a()(e),{headers:{"Content-Type":"application/json;charset=utf-8"}}).then(function(t){o(t.data)},function(t){s(t)})})};var s=o("mvHQ"),a=o.n(s),i=o("//Fk"),n=o.n(i),r=o("7+uW"),c=o("mtWM"),l=o.n(c),d=o("mw3O"),u=o.n(d),f=o("DWlv"),m=o.n(f);r.default.use(m.a,l.a);var p=l.a.create({timeout:5e3,baseURL:"http://apis.free.svipss.top/"});p.interceptors.response.use(function(t){return 200==t.status?t:n.a.reject("error")},function(t){return console.log("error"+t),p.isCancel(t)?new n.a(function(){}):n.a.reject(t.response)}),e.default=p},cmqu:function(t,e,o){var s={"./food/foodApi.js":"l+ng","./http.js":"Y8t/","./index.js":"gyMJ","./login/loginApi.js":"q+k7","./vip/vipApi.js":"JA5Q"};function a(t){return o(i(t))}function i(t){var e=s[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}a.keys=function(){return Object.keys(s)},a.resolve=i,t.exports=a,a.id="cmqu"},euWM:function(t,e){},gyMJ:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("o/zv"),a=o("cmqu"),i=a.keys().reduce(function(t,e){var o=a(e);return t[s.basename(e,".js")]=o.default,t},{});e.default=i},iEk4:function(t,e){},iQ4y:function(t,e){},"l+ng":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("Y8t/"),a={getFoodsType:function(t,e,o){return s.get("/food/getFoodsType",t).then(e).catch(o)},getFoodsList:function(t,e,o){return s.get("/food/getFoodsList",t).then(e).catch(o)},addFoodsType:function(t,e,o){return s.post("/food/addFoodsType",t).then(e).catch(o)},addFoodsDetail:function(t,e,o){return s.post("/food/addFoodsDetail",t).then(e).catch(o)},deleteFoodType:function(t,e,o){return s.post("/food/deleteFoodType",t).then(e).catch(o)},deleteFoods:function(t,e,o){return s.post("/food/deleteFoods",t).then(e).catch(o)},setOftenFoods:function(t,e,o){return s.post("/food/setOftenFoods",t).then(e).catch(o)},getOftenFoods:function(t,e,o){return s.get("/food/getOftenFoods",t).then(e).catch(o)},getFoodsAllList:function(t,e,o){return s.get("/food/getFoodsAllList",t).then(e).catch(o)},getFoodsVIPAllList:function(t,e,o){return s.get("/food/getFoodsVIPAllList",t).then(e).catch(o)}};e.default=a},lFqa:function(t,e){},mQWg:function(t,e){},neo8:function(t,e){},oYEz:function(t,e,o){t.exports=o.p+"static/img/未知.e7a3b2e.png"},"q+k7":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("Y8t/"),a={getUser:function(t,e,o){return s.post("/login/getUser",t).then(e).catch(o)},addUser:function(t,e,o){return s.post("/login/addUser",t).then(e).catch(o)},editUser:function(t,e,o){return s.post("/login/editUser",t).then(e).catch(o)}};e.default=a},tvR6:function(t,e){},"wk+j":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.27b9eb37844724ff5fa9.js.map